{"title":"Handling Missing Data: Foundations","markdown":{"yaml":{"title":"Handling Missing Data: Foundations"},"headingText":"When Data Isn't There","headingAttr":{"id":"sec-missing-data-foundations","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\n\n\nMissing data is inevitable in regulatory analytics. Providers don't submit data, surveys have non-response, systems fail to record values, staff forget to document. The question isn't \"do I have missing data?\" but \"**does it matter for my analysis?**\"\n\nThis chapter addresses the conceptual foundations you need before applying missing data methods:\n\n1. **Why does data go missing?** Understanding mechanisms (MCAR, MAR, MNAR)\n2. **What's the impact?** Distinguishing bias from loss of precision\n3. **When should I worry?** Decision framework for investigation\n4. **What are my options?** Principles for handling approaches\n\n**This chapter focuses on concepts.** For computational methods (multiple imputation, maximum likelihood, sensitivity analysis with code), see @sec-missing-data-handling.\n\n**Critical principle**: The most important question isn't \"how do I fill in missing values?\" It's \"**why is this data missing, and what does that tell me?**\" The missingness mechanism determines whether simple approaches work or whether you have a serious problem.\n\n## Why Data Goes Missing\n\nNot all missingness is equal. The reason data is missing determines whether it creates bias and what you can do about it.\n\n### Missing Completely at Random (MCAR)\n\n**Definition**: Missingness is unrelated to anything—observed or unobserved data.\n\n**Characteristics**:\n- Missing values are a random sample of all values\n- Probability of being missing is the same for all observations\n- Missingness unrelated to the value itself or any other variable\n\n**Examples**:\n- **Random system glitches**: Server fails at random times, losing 2% of records\n- **Lottery-based sampling**: You randomly select 100 of 200 providers to survey, leaving 100 \"missing\"\n- **Equipment failure**: A blood pressure monitor malfunctions on random patients\n\n**Impact on analysis**:\n- **No bias**: Complete cases are a random subset, so estimates are unbiased\n- **Loss of precision**: Smaller sample = wider confidence intervals = less statistical power\n- **Easy to handle**: Analyzing complete cases only is valid\n\n**Why it's rare in practice**: True randomness is uncommon. Usually missingness relates to something, even if subtly.\n\n**CQC context**: Rarely truly MCAR. Even system glitches often correlate with provider characteristics (e.g., older systems more likely to fail, smaller providers less likely to have backup systems).\n\n### Missing at Random (MAR)\n\n**Definition**: Missingness is related to observed variables, but not to the missing value itself (after accounting for observed variables).\n\n**Characteristics**:\n- Probability of being missing depends on things you observed\n- Once you account for those observed variables, missingness is random\n- Confusingly named—it's NOT random, but \"random conditional on observed data\"\n\n**Examples**:\n- **Smaller providers less likely to report**: Provider size is observed, and once you account for size, reporting is random. Small providers might be missing data on quality metrics, but conditional on size, the missingness is random.\n- **Older patients less likely to complete surveys**: Age is observed. Once you account for age, response is random. The missing satisfaction scores are missing because of age, not because of low satisfaction itself.\n- **Certain regions submit late**: Region is observed. Conditional on region, submission is random.\n\n**Impact on analysis**:\n- **Potential bias**: If you ignore the observed variables related to missingness, estimates can be biased\n- **Can be addressed**: If you account for the variables related to missingness (e.g., stratify by provider size, adjust for age), bias can be reduced or eliminated\n- **Requires more sophisticated methods**: Complete case analysis may be biased; need to model the missingness or use methods that account for it\n\n**Why it's common**: Many reporting and measurement processes correlate with observable characteristics.\n\n**CQC context**: Very common. Small providers, rural locations, older systems, high-workload periods—all observable factors that affect likelihood of missing data.\n\n**Key distinction from MCAR**: With MAR, missingness relates to things you can measure. With MCAR, missingness doesn't relate to anything.\n\n### Missing Not at Random (MNAR)\n\n**Definition**: Missingness is related to the unobserved value itself, even after accounting for all observed variables.\n\n**Characteristics**:\n- Probability of being missing depends on the value that would have been observed\n- Cannot be predicted from other observed variables alone\n- The missingness pattern itself contains information\n\n**Examples**:\n- **Poor performers don't report**: Providers with high incident rates choose not to submit incident data. The missingness is directly related to the (high) value they're not reporting.\n- **Low satisfaction prompts non-response**: Patients with negative experiences don't complete satisfaction surveys. The missing scores are missing *because* they're low.\n- **High costs trigger non-disclosure**: Providers with expensive care don't report cost data. Missingness correlates with (high) unreported costs.\n\n**Impact on analysis**:\n- **Serious bias**: No standard method can eliminate this bias without strong, unverifiable assumptions\n- **Results are misleading**: Complete case analysis gives biased estimates; imputation methods also biased unless they correctly model the MNAR mechanism\n- **Missingness is informative**: The pattern of who's missing tells you something important\n\n**Why it's serious**: You can't fix MNAR with statistics alone. The information needed to correct the bias is missing by definition.\n\n**CQC context**: A major concern in regulation. If poor performers systematically don't report, your analysis of complete cases paints an artificially rosy picture. This is a regulatory failure, not just a statistical problem.\n\n**Warning signs**:\n- Providers with poor inspection ratings have more missing data\n- Providers that later fail have historical gaps in reporting\n- Missingness correlates with complaints or safeguarding concerns\n- \"Too good to be true\" complete case results (everyone who reports looks fine)\n\n## Impact on Analysis: Bias vs Precision\n\nMissing data affects analysis in two ways. Understanding the difference is crucial.\n\n### Loss of Precision (Statistical Efficiency)\n\n**What it is**: Smaller sample size = wider confidence intervals = less ability to detect real effects.\n\n**Caused by**: All types of missingness (MCAR, MAR, MNAR)\n\n**Example**: You plan to compare 100 providers, but 20 have missing data. Analyzing 80 providers instead of 100 means less precise estimates—wider confidence intervals, lower statistical power.\n\n**Consequence**: You might miss real differences (false negatives), not because of bias but because you lack precision.\n\n**Solution**: Increase sample size if possible, or accept wider uncertainty. Some missing data methods (imputation) can recover some precision.\n\n**Regulatory implication**: Lower power means harder to detect genuinely poor performers. This affects false negative rate.\n\n### Bias (Systematic Error)\n\n**What it is**: Your estimate is systematically wrong—consistently too high or too low.\n\n**Caused by**: MAR (if you don't account for observed variables) and MNAR\n\n**Example**: Poor performers don't report. Analyzing complete cases only gives you an estimate of \"performance among providers who choose to report,\" which is better than overall performance. Your estimate is biased upward.\n\n**Consequence**: Wrong conclusions. You think performance is better (or worse) than it actually is.\n\n**Solution**: \n- For MAR: Account for variables related to missingness\n- For MNAR: Extremely difficult; requires specialist methods or sensitivity analysis\n\n**Regulatory implication**: Bias means your analysis is misleading. This affects both false positives and false negatives, and undermines credibility.\n\n**Key distinction**: \n- **Low precision**: Estimate is roughly right but uncertain (wide confidence interval)\n- **Bias**: Estimate is confidently wrong (might have narrow confidence interval, but pointing at the wrong value)\n\n**You can have both**: MNAR creates bias *and* reduces precision. MAR creates bias (if not handled) but precision can be partially recovered. MCAR only reduces precision.\n\n## Investigating Missing Data: When to Worry\n\nDon't apply mechanical thresholds like \"if >10% missing, exclude the variable.\" Instead, investigate the pattern and mechanism.\n\n### Step 1: Quantify\n\n**How much is missing?**\n\n- **Overall**: What proportion of all values are missing across your dataset?\n- **By variable**: Which variables have the most missing data?\n- **By observation**: How many observations are missing data on multiple variables?\n- **By subgroup**: Are certain types of providers (small, rural, specific sector) missing more data?\n\n**Tools**: Summary functions in statistical software (R: `colSums(is.na())`, Python: `.isnull().sum()`)\n\n**Red flag**: If missingness is concentrated in specific variables or subgroups, it's not random.\n\n### Step 2: Visualize\n\n**What pattern does missingness follow?**\n\n- **Scattered**: Missing values distributed throughout dataset (suggests MCAR)\n- **Clustered**: Missing values concentrated in specific observations or time periods (suggests MAR or MNAR)\n- **Monotone**: If A is missing, then B, C, D are also missing (suggests systematic dropout)\n- **Co-occurrence**: Certain variables always missing together (suggests related mechanisms)\n\n**Tools**: Missing data visualization packages (R: `naniar::vis_miss()`, `naniar::gg_miss_upset()`; Python: `missingno.matrix()`, `missingno.heatmap()`)\n\n**Red flag**: Clustered or patterned missingness suggests non-random mechanism.\n\n### Step 3: Investigate Relationships\n\n**Is missingness related to other variables?**\n\n**Compare characteristics**:\n- Do providers with missing data differ from complete-case providers on observed characteristics?\n- Are smaller providers more likely to have missing data?\n- Do providers with certain ratings have more missingness?\n- Does missingness vary by region, sector, or time period?\n\n**Tools**: Create a missingness indicator (1 = missing, 0 = not missing) and compare groups using t-tests or cross-tabs.\n\n**Example analysis**:\n```\n# Do small providers have more missing data?\nSmall providers with missing data: 40%\nLarge providers with missing data: 10%\n→ Suggests MAR (related to size)\n```\n\n**Red flag**: If providers with known risk factors (complaints, poor ratings) have more missingness, suspect MNAR.\n\n### Step 4: Ask Why\n\n**Why is it missing?**\n\nConsult with data owners, inspect metadata, check documentation:\n\n- **Data collection issue**: System failure, process change, new requirement (potentially MCAR or MAR)\n- **Not applicable**: Metric doesn't apply to this provider type (not missing, but NA—handle separately)\n- **Deliberate non-reporting**: Provider chose not to submit (likely MNAR)\n- **Measurement failure**: Value couldn't be measured or recorded (potentially MCAR)\n- **Late submission**: Data exists but not yet available (time-dependent MAR)\n\n**CQC practice**: Check with data managers, review provider history, consider regulatory context (are providers required to submit? What are consequences of non-reporting?).\n\n## Decision Framework: What to Do\n\nBased on investigation, decide how to proceed.\n\n### Scenario 1: Minor Missingness, Random Pattern\n\n**Characteristics**:\n- <5-10% missing across most variables\n- Scattered, no obvious pattern\n- Missing and complete cases similar on observed characteristics\n- Investigation suggests plausible MCAR mechanism\n\n**Decision**: Complete case analysis usually appropriate\n\n**Action**:\n1. Exclude observations with missing data\n2. Report sample size before and after exclusion\n3. Document why you believe missingness is MCAR\n4. Conduct quick sensitivity check: do complete cases differ from all cases on observed variables?\n\n**Document**:\n- \"3% of providers (n=15) excluded due to missing incident data. Investigation showed no systematic pattern; providers with missing data did not differ from complete cases on size, region, or rating.\"\n\n**Limitation**: Still loses precision. Consider whether 5-10% loss is acceptable for your question.\n\n### Scenario 2: Moderate Missingness, Explained by Observed Variables\n\n**Characteristics**:\n- 10-30% missing on key variables\n- Clear pattern: smaller providers, certain regions, specific time periods\n- Missingness correlates with observed characteristics\n- Investigation suggests MAR mechanism\n\n**Decision**: Account for observed variables or conduct sensitivity analysis\n\n**Options**:\n1. **Stratified analysis**: Analyze small and large providers separately, then synthesize\n2. **Adjustment**: Include size/region/period as covariates in your model\n3. **Weighting**: Weight complete cases by inverse probability of having complete data\n4. **Imputation**: Use methods that account for observed variables (requires specialist support, see @sec-missing-data-handling)\n5. **Sensitivity analysis**: Compare results for complete cases vs making different assumptions about missing data\n\n**Action**:\n- Choose approach based on complexity and stakes\n- For high-stakes analysis, consult Guild for imputation methods\n- For routine analysis, sensitivity analysis often sufficient\n\n**Document**:\n- \"20% of small providers had missing satisfaction data vs 5% of large providers. We analyzed small and large providers separately to avoid bias from differential missingness.\"\n\n**Limitation**: Relies on assumption that missingness is MAR (conditional on observed variables). If MNAR, still biased.\n\n### Scenario 3: Substantial Missingness or Problematic Pattern\n\n**Characteristics**:\n- >30% missing on key variables\n- Missingness correlates with outcome or suspected risk factors\n- Providers known to be higher-risk have more missing data\n- Investigation raises concerns about MNAR\n\n**Decision**: Do NOT proceed with standard analysis\n\n**Action**:\n1. **Escalate to Guild**: This requires specialist methods or may indicate indicator isn't fit for purpose\n2. **Report missingness as a finding**: \"40% of providers did not report incident data, concentrated among providers with previous safeguarding concerns. This pattern of non-reporting is itself a regulatory concern.\"\n3. **Sensitivity analysis**: Best-case (all missing values are good) vs worst-case (all missing values are bad) scenarios to bound possible conclusions\n4. **Consider redesign**: Is this indicator worth continuing if missingness is this severe?\n\n**Document**:\n- \"We cannot draw valid conclusions about incident rates because 40% of providers did not report, and non-reporting was concentrated among providers with known concerns. We recommend reviewing reporting requirements and considering sanctions for non-compliance.\"\n\n**Limitation**: No statistical fix. This is a data governance and policy problem.\n\n### Scenario 4: MNAR Suspected\n\n**Characteristics**:\n- Investigation suggests poor performers systematically don't report\n- Historical data shows providers that later failed had prior missing data\n- Regulatory intelligence supports non-reporting related to performance\n\n**Decision**: Treat missingness pattern itself as a signal\n\n**Action**:\n1. **Flag non-reporters**: Missing data is itself informative. Providers who don't report may warrant investigation.\n2. **Sensitivity analysis**: Model different scenarios (best case, worst case, various assumptions)\n3. **Guild consultation**: Specialist methods exist (selection models, pattern-mixture models) but require strong assumptions and expertise\n4. **Policy response**: Consider whether regulatory action is needed to improve reporting compliance\n\n**Document**:\n- \"We cannot produce unbiased estimates of performance due to non-random missingness. However, the pattern of non-reporting—concentrated among providers with complaints and previous enforcement—is itself a regulatory concern. We flag these providers for investigation.\"\n\n**Key insight**: With MNAR, the analytic question shifts from \"what is average performance?\" to \"what does the pattern of missingness tell us?\"\n\n## Handling Approaches: Principles\n\nBefore diving into computational methods (@sec-missing-data-handling), understand the principles.\n\n### Complete Case Analysis (Listwise Deletion)\n\n**What**: Analyze only observations with no missing data.\n\n**When valid**: \n- MCAR (unbiased, just loses precision)\n- MAR with stratification or adjustment for observed variables\n- Small amount of missingness (<5%) where bias is likely minimal\n\n**When NOT valid**:\n- MAR without accounting for related variables (biased)\n- MNAR (biased)\n- Substantial missingness (loses too much precision)\n\n**Advantages**:\n- Simple\n- Transparent\n- No assumptions about missing values themselves\n\n**Disadvantages**:\n- Loses data and precision\n- Can be severely biased if missingness not MCAR\n- With multiple variables, can lose most of dataset\n\n**CQC practice**: Default for minor missingness. Always report sample size before and after exclusion.\n\n### Indicator Methods (Missing as a Category)\n\n**What**: Create a separate category for missing values (e.g., \"Not reported\") and include it in analysis.\n\n**When valid**:\n- Missingness itself is meaningful (e.g., \"provider chose not to report\")\n- You want to explicitly model non-reporting as a separate group\n- Exploratory analysis to see if missingness predicts outcomes\n\n**When NOT valid**:\n- You want to estimate what the missing values would have been (this doesn't do that)\n- Small number of missing cases (creates unstable estimates for missing category)\n- Missingness has no substantive meaning\n\n**Advantages**:\n- Retains all data\n- Makes missingness visible in results\n- Can reveal patterns of non-reporting\n\n**Disadvantages**:\n- Doesn't estimate what missing values are\n- Can be difficult to interpret (\"missing category\" vs actual values)\n- Not appropriate for all analysis types\n\n**CQC example**: In profiling providers, create three categories: \"Below average\", \"Average\", \"Above average\", \"Not reported\". Report all four groups. Providers who don't report are visible, but you're not imputing their values.\n\n### Advanced Methods (See Methods Chapter)\n\n**When needed**: MAR with substantial missingness, or high-stakes analysis requiring sophisticated approaches\n\n**Options** (detailed in @sec-missing-data-handling):\n- **Multiple imputation**: Fill in missing values multiple times, analyze each, pool results\n- **Maximum likelihood**: Estimate parameters directly from available data\n- **Inverse probability weighting**: Weight complete cases by inverse probability of being complete\n- **Sensitivity analysis**: Test different assumptions about missing values\n\n**When to escalate**: \n- >20-30% missing and MAR\n- High-stakes regulatory decision\n- Stakeholder concern about bias\n- Methodological challenge expected\n\n**Key limitation**: All advanced methods assume MAR or require strong assumptions about MNAR. They improve on complete case analysis under MAR, but they can't eliminate MNAR bias without unverifiable assumptions.\n\n## Documenting Missing Data\n\nFor QA purposes (@sec-qa-principles), always document:\n\n**What's missing**:\n- Amount (counts and percentages)\n- Variables affected\n- Observations affected\n- Time period (is missingness increasing or decreasing?)\n\n**Why it's missing**:\n- Your investigation findings\n- Likely mechanism (MCAR, MAR, MNAR)\n- Supporting evidence for mechanism\n\n**What you did**:\n- Approach chosen (complete case, stratification, imputation, etc.)\n- Rationale for approach\n- Assumptions required\n\n**What it means**:\n- Limitations created by missingness\n- Potential bias direction and magnitude\n- Uncertainty about conclusions\n- Sensitivity of results to missing data handling\n\n**Template**:\n> \"Provider satisfaction data was missing for 18% of providers (n=45). Investigation showed smaller providers (<50 beds) were more likely to have missing data (30% missing) than larger providers (8% missing), suggesting MAR. We conducted stratified analysis for small and large providers separately to avoid bias from differential missingness. Results should be interpreted cautiously for small providers given reduced sample size (n=105 small providers with complete data from 150 total).\"\n\n::: {.callout-note icon=false}\n## Rethinking: Missing Data as a Signal, Not Just a Problem\n\nIn regulatory contexts, missing data often *is* the finding, not just an obstacle to analysis.\n\n**Why non-reporting matters**:\n\n- **Transparency indicator**: Providers who don't report may have poor data governance\n- **Risk signal**: Historical non-reporting predicts future problems\n- **Compliance issue**: Failure to meet reporting requirements is itself a concern\n- **Pattern recognition**: Multiple providers in a chain not reporting suggests systematic issue\n\n**Reframe the question**:\n- Not: \"How do I get around missing data to estimate performance?\"\n- But: \"What does the pattern of missingness tell me about provider behavior?\"\n\n**Example**: You're analyzing incident rates. Complete case analysis shows average rate is 8/month. But 40% of providers didn't report. \n\n**Standard framing**: \"We can't draw conclusions because of missingness.\"\n\n**Regulatory framing**: \"40% of providers failed to report incidents as required. This non-compliance is itself a regulatory finding requiring investigation. Among providers who reported, average rate was 8/month, but this may overestimate quality if non-reporters have higher rates.\"\n\n**Action**: Flag non-reporters for investigation, not just to check for high incident rates, but to understand why they're not reporting.\n\n**Key insight**: In academic research, missing data is an obstacle to unbiased inference. In regulation, systematic non-reporting may be more important than the values themselves.\n:::\n\n::: {.callout-warning icon=false}\n## Overthinking: The MAR Assumption Is Often Unverifiable\n\n**Fundamental problem**: You can't definitively prove data is MAR vs MNAR, because the distinction depends on the unobserved values.\n\n**What you can check**:\n- Whether missingness correlates with observed variables (if not, might be MCAR)\n- Whether missing and complete cases differ on observed characteristics (if they do, not MCAR)\n\n**What you CANNOT check**:\n- Whether missingness correlates with the unobserved values themselves\n- Among observations with the same observed characteristics, whether missingness correlates with the missing value\n\n**Implication**: Advanced missing data methods assume MAR. This assumption is convenient but unverifiable. Results depend on this assumption being true.\n\n**What to do**:\n\n1. **Make reasonable judgments**: Use domain knowledge. If poor performers have incentive to not report, assume MNAR. If missingness is administrative (late submission), assume MAR.\n\n2. **Sensitivity analysis**: Test how results change under different assumptions about MNAR.\n\n3. **Document assumptions**: Be explicit about what you're assuming and why.\n\n4. **Acknowledge limits**: Even sophisticated imputation can't overcome MNAR without strong assumptions.\n\n**CQC practice**: Most regulatory analysis should assume data is NOT MAR unless you have good evidence otherwise. Non-reporting often correlates with poor performance (MNAR). Document this assumption and its implications for interpretation.\n:::\n\n## Looking Ahead: Methods Chapter\n\nThis chapter covered the conceptual foundations. For computational methods, see @sec-missing-data-handling, which covers:\n\n- **Quantifying and visualizing** missingness patterns with code\n- **Sensitivity analysis** frameworks and implementation\n- **Multiple imputation** when and how to use it\n- **R and Python code** for all approaches\n- **Worked examples** with CQC-realistic scenarios\n\n**When to use methods chapter**: After you've investigated missingness using this chapter's framework and determined that simple complete case analysis is insufficient.\n\n## Key Takeaways\n\n::: {.callout-important icon=false}\n## Essential Points\n\n1. **Mechanism matters most**: MCAR, MAR, and MNAR have different implications. Investigation is critical before choosing an approach.\n\n2. **Bias vs precision**: Missing data always reduces precision. MAR and MNAR also create bias. Understand which problem you're dealing with.\n\n3. **No mechanical thresholds**: \"10% missing\" doesn't automatically mean anything. Pattern and mechanism matter more than percentage.\n\n4. **Complete case is default**: For minor missingness (~5%) with random pattern, analyzing complete cases only is usually appropriate. Document and move on.\n\n5. **Investigate before acting**: Quantify, visualize, understand relationships, ask why. This investigation is more important than any statistical method.\n\n6. **MNAR is serious**: If poor performers don't report, no standard method fixes the bias. Treat non-reporting as a finding itself.\n\n7. **Missingness can be informative**: In regulation, who doesn't report often tells you as much as the reported values.\n\n8. **Document everything**: Amount, pattern, mechanism, approach, assumptions, limitations. Essential for QA and credibility.\n\nThese principles guide the choice of methods detailed in @sec-missing-data-handling.\n:::\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../custom.css"],"toc":true,"toc-depth":3,"number-sections":true,"output-file":"08-missing-data-foundations.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.251","bibliography":["../references.bib"],"theme":"cosmo","number-depth":2,"title":"Handling Missing Data: Foundations"},"extensions":{"book":{"multiFile":true}}}}}